# Replit Prompt: Fix Agent Details Section â€” Auto-Fill from Settings

## ğŸ¯ Objective

Fix the **Agent Details** and **Branding & Logos** sections to:

1. Auto-fill **Agent Name**, **Title**, **Phone Number** from Settings (Agent Marketing Profile)
2. **Remove** Zoom, Horizontal, Vertical sliders and Reset button from Agent Photo
3. Keep Agent Photo simple (display only, no crop controls)

---

## ğŸ“ Current State vs Expected

| Element | Current | Expected |
|---------|---------|----------|
| Agent Name | Empty field | Auto-filled from Settings `firstName` + `lastName` |
| Title | Empty field | Auto-filled from Settings `title` |
| Phone Number | Empty field | Auto-filled from Settings `phone` |
| Agent Photo | Has Zoom/Horizontal/Vertical/Reset | Display only, NO crop controls |
| Company Logo | âœ… Working | Keep as-is |
| Secondary Logo | âœ… Working | Keep as-is |
| QR Code | Upload option | Keep as-is |

---

## ğŸ”§ Fix 1: Auto-Fill Agent Details from Settings

### Fetch Settings Data

```tsx
// In AdvancedFlyerGenerator or parent component

import { useQuery } from '@tanstack/react-query';

// Fetch settings (Agent Marketing Profile)
const { data: settings, isLoading: settingsLoading } = useQuery({
  queryKey: ['/api/settings'],
});
```

### Auto-Fill Form Fields

```tsx
// useEffect to populate agent fields when settings load
useEffect(() => {
  if (!settings) return;

  console.log('Settings loaded:', settings);

  // Build agent name from firstName + lastName
  const firstName = settings.firstName || '';
  const lastName = settings.lastName || '';
  const agentName = `${firstName} ${lastName}`.trim();

  // Set form values
  form.setValue('agentName', agentName || 'Agent Name');
  form.setValue('agentTitle', settings.title || 'REALTORÂ®');
  form.setValue('phone', settings.phone || '');

  // Set agent photo from profilePhoto
  setImages(prev => ({
    ...prev,
    agentPhoto: settings.profilePhoto || null,
    qrCode: settings.qrCode || null,
    // Logos with default toggle logic
    companyLogo: settings.companyLogoUseDefault !== false
      ? '/logos/SpyglassRealty_Logo_Black.png'
      : settings.companyLogo || '/logos/SpyglassRealty_Logo_Black.png',
    secondaryLogo: settings.secondaryLogoUseDefault !== false
      ? '/logos/LeadingRE_Logo.png'
      : settings.secondaryLogo || '/logos/LeadingRE_Logo.png',
  }));

}, [settings, form]);
```

---

## ğŸ”§ Fix 2: Update Agent Details Section UI

Replace the Agent Details section with auto-filled fields:

```tsx
{/* ================================================ */}
{/* AGENT DETAILS SECTION                            */}
{/* ================================================ */}
<div className="space-y-4">
  <div className="flex items-center gap-2">
    <User className="w-5 h-5 text-primary" />
    <h2 className="text-lg font-medium">Agent Details</h2>
  </div>
  
  <Separator />
  
  {/* Auto-fill indicator */}
  <div className="flex items-center gap-2 text-green-600 text-sm">
    <Check className="w-4 h-4" />
    <span>Using data from Settings</span>
  </div>

  {/* Agent Name - Auto-filled but editable */}
  <div className="space-y-2">
    <Label className="text-xs font-medium uppercase tracking-wide">
      Agent Name
    </Label>
    <Input
      {...form.register('agentName')}
      placeholder="Agent Name"
      className="bg-background"
    />
  </div>

  {/* Title - Auto-filled but editable */}
  <div className="space-y-2">
    <Label className="text-xs font-medium uppercase tracking-wide">
      Title
    </Label>
    <Input
      {...form.register('agentTitle')}
      placeholder="REALTORÂ®"
      className="bg-background"
    />
  </div>

  {/* Phone Number - Auto-filled but editable */}
  <div className="space-y-2">
    <div className="flex items-center gap-2">
      <Phone className="w-4 h-4 text-muted-foreground" />
      <Label className="text-xs font-medium uppercase tracking-wide">
        Phone Number
      </Label>
    </div>
    <Input
      {...form.register('phone')}
      placeholder="(555) 123-4567"
      className="bg-background"
    />
  </div>
</div>
```

---

## ğŸ”§ Fix 3: Update Branding & Logos Section (Remove Crop Controls)

Replace the Branding & Logos section - keep Agent Photo simple without crop controls:

```tsx
{/* ================================================ */}
{/* BRANDING & LOGOS SECTION                         */}
{/* ================================================ */}
<div className="space-y-4">
  <div className="flex items-center gap-2">
    <ImageIcon className="w-5 h-5 text-primary" />
    <h2 className="text-lg font-medium">Branding & Logos</h2>
  </div>
  
  <Separator />
  
  {/* Auto-fill indicator */}
  <div className="flex items-center gap-2 text-green-600 text-sm">
    <Check className="w-4 h-4" />
    <span>Using saved marketing profile</span>
  </div>

  {/* Company Logo & Secondary Logo - Side by Side */}
  <div className="grid grid-cols-2 gap-4">
    {/* Company Logo */}
    <div className="space-y-2">
      <Label className="text-xs font-medium uppercase tracking-wide">
        Company Logo
      </Label>
      <div className="h-16 rounded-lg border border-border bg-white flex items-center justify-center p-2">
        {images.companyLogo ? (
          <img
            src={images.companyLogo}
            alt="Company Logo"
            className="h-full object-contain"
          />
        ) : (
          <span className="text-xs text-muted-foreground">No logo</span>
        )}
      </div>
    </div>

    {/* Secondary Logo */}
    <div className="space-y-2">
      <Label className="text-xs font-medium uppercase tracking-wide">
        Secondary Logo
      </Label>
      <div className="h-16 rounded-lg border border-border bg-white flex items-center justify-center p-2">
        {images.secondaryLogo ? (
          <img
            src={images.secondaryLogo}
            alt="Secondary Logo"
            className="h-full object-contain"
          />
        ) : (
          <span className="text-xs text-muted-foreground">No logo</span>
        )}
      </div>
    </div>
  </div>

  {/* Agent Photo & QR Code - Side by Side */}
  <div className="grid grid-cols-2 gap-4">
    {/* Agent Photo - SIMPLE, NO CROP CONTROLS */}
    <div className="space-y-2">
      <Label className="text-xs font-medium uppercase tracking-wide">
        Agent Photo
      </Label>
      <div className="relative">
        {images.agentPhoto ? (
          <div className="w-24 h-24 mx-auto rounded-full overflow-hidden border-2 border-border">
            <img
              src={images.agentPhoto}
              alt="Agent"
              className="w-full h-full object-cover"
            />
          </div>
        ) : (
          <div className="w-24 h-24 mx-auto rounded-full border-2 border-dashed border-muted-foreground/30 flex items-center justify-center bg-muted/50">
            <User className="w-8 h-8 text-muted-foreground" />
          </div>
        )}
        {/* Optional: Change photo button */}
        <label className="absolute bottom-0 right-1/2 translate-x-1/2 translate-y-1/2">
          <Button
            type="button"
            variant="outline"
            size="sm"
            className="h-6 text-[10px] gap-1 bg-background"
            asChild
          >
            <span>
              <Upload className="w-3 h-3" />
              Change
              <input
                type="file"
                accept="image/*"
                onChange={(e) => {
                  const file = e.target.files?.[0];
                  if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                      setImages(prev => ({ ...prev, agentPhoto: reader.result as string }));
                    };
                    reader.readAsDataURL(file);
                  }
                }}
                className="hidden"
              />
            </span>
          </Button>
        </label>
      </div>
      {/* NO ZOOM/HORIZONTAL/VERTICAL/RESET CONTROLS */}
    </div>

    {/* QR Code */}
    <div className="space-y-2">
      <Label className="text-xs font-medium uppercase tracking-wide">
        QR Code
      </Label>
      <label className="block cursor-pointer">
        {images.qrCode ? (
          <div className="w-24 h-24 mx-auto rounded-lg border border-border overflow-hidden bg-white p-1">
            <img
              src={images.qrCode}
              alt="QR Code"
              className="w-full h-full object-contain"
            />
          </div>
        ) : (
          <div className="w-24 h-24 mx-auto rounded-lg border-2 border-dashed border-muted-foreground/30 flex flex-col items-center justify-center bg-muted/50 hover:border-primary/50 transition-colors">
            <Upload className="w-5 h-5 text-muted-foreground mb-1" />
            <span className="text-[10px] text-muted-foreground">Click to upload</span>
          </div>
        )}
        <input
          type="file"
          accept="image/*"
          onChange={(e) => {
            const file = e.target.files?.[0];
            if (file) {
              const reader = new FileReader();
              reader.onloadend = () => {
                setImages(prev => ({ ...prev, qrCode: reader.result as string }));
              };
              reader.readAsDataURL(file);
            }
          }}
          className="hidden"
        />
      </label>
    </div>
  </div>
</div>
```

---

## ğŸ”§ Fix 4: Remove Crop Controls from ImageTransforms State

If you have `imageTransforms` state for agentPhoto, you can remove it or simply not use it:

```tsx
// REMOVE these from imageTransforms state (if they exist):
// - agentPhoto transform controls

// The imageTransforms should only be for property photos (if needed):
const [imageTransforms, setImageTransforms] = useState({
  mainImage: { scale: 1, positionX: 0, positionY: 0 },
  kitchenImage: { scale: 1, positionX: 0, positionY: 0 },
  roomImage: { scale: 1, positionX: 0, positionY: 0 },
  // NO agentPhoto here - removed
});
```

---

## ğŸ“Š Visual Layout After Fix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ AGENT DETAILS                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ Using data from Settings                          â”‚
â”‚                                                     â”‚
â”‚ AGENT NAME                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Daryl Camingao                                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ TITLE                                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ AI Web Developer                                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ ğŸ“ PHONE NUMBER                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 546-546-5123                                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ–¼ï¸ BRANDING & LOGOS                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ Using saved marketing profile                     â”‚
â”‚                                                     â”‚
â”‚ COMPANY LOGO              SECONDARY LOGO            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ â”‚   SPYGLASS    â”‚         â”‚ SPYGLASS |    â”‚        â”‚
â”‚ â”‚    REALTY     â”‚         â”‚  Leading      â”‚        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                     â”‚
â”‚ AGENT PHOTO               QR CODE                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”               â”‚
â”‚     â”‚ ğŸ‘¤  â”‚                  â”‚     â”‚               â”‚
â”‚     â”‚photoâ”‚                  â”‚ QR  â”‚               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”˜               â”‚
â”‚    [Change]               Click to upload           â”‚
â”‚                                                     â”‚
â”‚  âŒ NO Zoom slider                                  â”‚
â”‚  âŒ NO Horizontal slider                            â”‚
â”‚  âŒ NO Vertical slider                              â”‚
â”‚  âŒ NO Reset button                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Verification Checklist

### Agent Details Auto-Fill
- [ ] Agent Name shows `firstName + lastName` from Settings
- [ ] Title shows `title` from Settings  
- [ ] Phone Number shows `phone` from Settings
- [ ] Fields are editable (agent can override if needed)
- [ ] Green checkmark shows "Using data from Settings"

### Branding & Logos
- [ ] Company Logo displays from Settings
- [ ] Secondary Logo displays from Settings
- [ ] Agent Photo displays from Settings `profilePhoto`
- [ ] QR Code shows if available, otherwise upload option
- [ ] "Change" button allows updating agent photo

### Removed Elements
- [ ] âŒ Zoom slider removed from Agent Photo
- [ ] âŒ Horizontal slider removed from Agent Photo
- [ ] âŒ Vertical slider removed from Agent Photo
- [ ] âŒ Reset button removed from Agent Photo

### Live Preview Sync
- [ ] Agent Name change â†’ Preview updates
- [ ] Title change â†’ Preview updates
- [ ] Phone change â†’ Preview updates
- [ ] Agent Photo change â†’ Preview updates

---

## ğŸ“‹ Settings Fields Reference

| Settings Field | Form Field | Usage |
|----------------|------------|-------|
| `firstName` | Part of `agentName` | Combined with lastName |
| `lastName` | Part of `agentName` | Combined with firstName |
| `title` | `agentTitle` | e.g., "REALTORÂ®", "Broker" |
| `phone` | `phone` | Contact number |
| `profilePhoto` | `images.agentPhoto` | Circular photo on flyer |
| `qrCode` | `images.qrCode` | QR code image |
| `companyLogo` | `images.companyLogo` | Main logo (or Spyglass default) |
| `companyLogoUseDefault` | Toggle logic | Use default if true |
| `secondaryLogo` | `images.secondaryLogo` | Secondary logo (or Leading RE default) |
| `secondaryLogoUseDefault` | Toggle logic | Use default if true |

---

*This fix focuses on the Agent Details and Branding sections. The key changes are auto-filling from Settings and removing the unnecessary crop controls from Agent Photo.*