# Contract Conduit â€” Branding & Logos Section Implementation

## ğŸ“Œ Purpose

Add the **Branding & Logos** section to the Advanced Flyer Builder left pane with:
1. Company Logo upload (with Spyglass default)
2. Secondary Logo upload (with Leading RE default)
3. Primary Logo Size slider (50%-200%)
4. Secondary Logo Size slider (50%-200%)
5. Divider Position slider (100-200px)
6. Secondary Logo Y Position slider (Â±20px)

---

## ğŸ¨ Visual Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¨ Branding & Logos                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  COMPANY LOGO              SECONDARY LOGO                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚                 â”‚      â”‚                 â”‚              â”‚
â”‚  â”‚   [Spyglass]    â”‚      â”‚  [Leading RE]   â”‚              â”‚
â”‚  â”‚      Logo       â”‚      â”‚     Logo        â”‚              â”‚
â”‚  â”‚                 â”‚      â”‚                 â”‚              â”‚
â”‚  â”‚  Click to uploadâ”‚      â”‚  Click to uploadâ”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚  â˜‘ Use Default            â˜‘ Use Default                    â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Primary Logo Size                              100%        â”‚
â”‚  â—‹â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‹              â”‚
â”‚  50%                                          200%          â”‚
â”‚                                                             â”‚
â”‚  Secondary Logo Size                            100%        â”‚
â”‚  â—‹â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‹              â”‚
â”‚  50%                                          200%          â”‚
â”‚                                                             â”‚
â”‚  Divider Position                               148px       â”‚
â”‚  â—‹â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‹              â”‚
â”‚  100px                                        200px         â”‚
â”‚                                                             â”‚
â”‚  Secondary Logo Y Position                       0px        â”‚
â”‚  â—‹â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‹              â”‚
â”‚  -20px                                        +20px         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ State Management

Add these state variables to the main Flyer Generator component:

```typescript
// Logo images
const [companyLogo, setCompanyLogo] = useState<string | null>('/logos/SpyglassRealty_Logo_Black.png');
const [secondaryLogo, setSecondaryLogo] = useState<string | null>('/logos/LeadingRE_Logo.png');

// Default toggles
const [useDefaultCompanyLogo, setUseDefaultCompanyLogo] = useState(true);
const [useDefaultSecondaryLogo, setUseDefaultSecondaryLogo] = useState(true);

// Logo controls
const [logoScales, setLogoScales] = useState({
  primary: 1,    // 1 = 100%
  secondary: 1,  // 1 = 100%
});
const [dividerPosition, setDividerPosition] = useState(148); // pixels
const [secondaryLogoOffsetY, setSecondaryLogoOffsetY] = useState(0); // pixels
```

---

## ğŸ–¼ï¸ Default Logo Files

Ensure these logo files exist in your public folder:

```
public/
â””â”€â”€ logos/
    â”œâ”€â”€ SpyglassRealty_Logo_Black.png    (Primary - Spyglass)
    â”œâ”€â”€ SpyglassRealty_Logo_White.png    (For dark backgrounds)
    â””â”€â”€ LeadingRE_Logo.png               (Secondary - Leading RE)
```

If not available, download from Spyglass brand assets or use placeholder paths.

---

## ğŸ“ Branding & Logos Component

Add this section to the left pane form (after Agent Details, before Property Images):

```tsx
{/* ============================================ */}
{/* Section: Branding & Logos                   */}
{/* ============================================ */}
<div className="space-y-4">
  <div className="flex items-center gap-2">
    <Palette className="h-5 w-5 text-primary" />
    <h2 className="text-lg font-medium">Branding & Logos</h2>
  </div>
  <Separator />
  
  {/* Logo Upload Areas */}
  <div className="grid grid-cols-2 gap-4">
    {/* Company Logo */}
    <div className="space-y-2">
      <Label className="text-xs font-medium text-muted-foreground uppercase tracking-wider">
        Company Logo
      </Label>
      <div 
        className="relative h-20 border-2 border-dashed border-border rounded-lg flex items-center justify-center bg-muted/30 cursor-pointer hover:bg-muted/50 transition-colors"
        onClick={() => !useDefaultCompanyLogo && companyLogoInputRef.current?.click()}
      >
        {companyLogo ? (
          <img 
            src={companyLogo} 
            alt="Company Logo" 
            className="max-h-14 max-w-full object-contain"
            style={{ transform: `scale(${logoScales.primary})` }}
          />
        ) : (
          <div className="text-center text-muted-foreground">
            <Upload className="h-6 w-6 mx-auto mb-1" />
            <span className="text-xs">Click to upload</span>
          </div>
        )}
        <input
          ref={companyLogoInputRef}
          type="file"
          accept="image/*"
          className="hidden"
          onChange={(e) => handleLogoUpload(e, 'company')}
          disabled={useDefaultCompanyLogo}
        />
      </div>
      <div className="flex items-center gap-2">
        <Checkbox
          id="useDefaultCompany"
          checked={useDefaultCompanyLogo}
          onCheckedChange={(checked) => {
            setUseDefaultCompanyLogo(!!checked);
            if (checked) {
              setCompanyLogo('/logos/SpyglassRealty_Logo_Black.png');
            }
          }}
        />
        <Label htmlFor="useDefaultCompany" className="text-xs text-muted-foreground cursor-pointer">
          Use Spyglass Default
        </Label>
      </div>
    </div>
    
    {/* Secondary Logo */}
    <div className="space-y-2">
      <Label className="text-xs font-medium text-muted-foreground uppercase tracking-wider">
        Secondary Logo
      </Label>
      <div 
        className="relative h-20 border-2 border-dashed border-border rounded-lg flex items-center justify-center bg-muted/30 cursor-pointer hover:bg-muted/50 transition-colors"
        onClick={() => !useDefaultSecondaryLogo && secondaryLogoInputRef.current?.click()}
      >
        {secondaryLogo ? (
          <img 
            src={secondaryLogo} 
            alt="Secondary Logo" 
            className="max-h-14 max-w-full object-contain"
            style={{ transform: `scale(${logoScales.secondary})` }}
          />
        ) : (
          <div className="text-center text-muted-foreground">
            <Upload className="h-6 w-6 mx-auto mb-1" />
            <span className="text-xs">Click to upload</span>
          </div>
        )}
        <input
          ref={secondaryLogoInputRef}
          type="file"
          accept="image/*"
          className="hidden"
          onChange={(e) => handleLogoUpload(e, 'secondary')}
          disabled={useDefaultSecondaryLogo}
        />
      </div>
      <div className="flex items-center gap-2">
        <Checkbox
          id="useDefaultSecondary"
          checked={useDefaultSecondaryLogo}
          onCheckedChange={(checked) => {
            setUseDefaultSecondaryLogo(!!checked);
            if (checked) {
              setSecondaryLogo('/logos/LeadingRE_Logo.png');
            }
          }}
        />
        <Label htmlFor="useDefaultSecondary" className="text-xs text-muted-foreground cursor-pointer">
          Use Leading RE Default
        </Label>
      </div>
    </div>
  </div>
  
  {/* Logo Size & Position Sliders */}
  <div className="space-y-4 pt-2">
    {/* Primary Logo Size */}
    <div className="space-y-2">
      <div className="flex items-center justify-between">
        <Label className="text-xs text-muted-foreground">Primary Logo Size</Label>
        <span className="text-xs text-muted-foreground font-medium">
          {Math.round(logoScales.primary * 100)}%
        </span>
      </div>
      <Slider
        value={[logoScales.primary]}
        onValueChange={([value]) => setLogoScales(prev => ({ ...prev, primary: value }))}
        min={0.5}
        max={2}
        step={0.05}
        className="py-2"
      />
    </div>
    
    {/* Secondary Logo Size */}
    <div className="space-y-2">
      <div className="flex items-center justify-between">
        <Label className="text-xs text-muted-foreground">Secondary Logo Size</Label>
        <span className="text-xs text-muted-foreground font-medium">
          {Math.round(logoScales.secondary * 100)}%
        </span>
      </div>
      <Slider
        value={[logoScales.secondary]}
        onValueChange={([value]) => setLogoScales(prev => ({ ...prev, secondary: value }))}
        min={0.5}
        max={2}
        step={0.05}
        className="py-2"
      />
    </div>
    
    {/* Divider Position */}
    <div className="space-y-2">
      <div className="flex items-center justify-between">
        <Label className="text-xs text-muted-foreground">Divider Position</Label>
        <span className="text-xs text-muted-foreground font-medium">
          {dividerPosition}px
        </span>
      </div>
      <Slider
        value={[dividerPosition]}
        onValueChange={([value]) => setDividerPosition(value)}
        min={100}
        max={200}
        step={1}
        className="py-2"
      />
    </div>
    
    {/* Secondary Logo Y Position */}
    <div className="space-y-2">
      <div className="flex items-center justify-between">
        <Label className="text-xs text-muted-foreground">Secondary Logo Y Position</Label>
        <span className="text-xs text-muted-foreground font-medium">
          {secondaryLogoOffsetY}px
        </span>
      </div>
      <Slider
        value={[secondaryLogoOffsetY]}
        onValueChange={([value]) => setSecondaryLogoOffsetY(value)}
        min={-20}
        max={20}
        step={1}
        className="py-2"
      />
    </div>
  </div>
</div>
```

---

## ğŸ“¤ Logo Upload Handler

```typescript
const companyLogoInputRef = useRef<HTMLInputElement>(null);
const secondaryLogoInputRef = useRef<HTMLInputElement>(null);

const handleLogoUpload = (e: React.ChangeEvent<HTMLInputElement>, type: 'company' | 'secondary') => {
  const file = e.target.files?.[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = () => {
    const dataUrl = reader.result as string;
    if (type === 'company') {
      setCompanyLogo(dataUrl);
      setUseDefaultCompanyLogo(false);
    } else {
      setSecondaryLogo(dataUrl);
      setUseDefaultSecondaryLogo(false);
    }
  };
  reader.readAsDataURL(file);
};
```

---

## ğŸ–¼ï¸ Live Preview Header Update

Update the FlyerPreview component header to use the logo controls:

```tsx
{/* ====== HEADER WITH LOGOS ====== */}
<div className="flex items-center h-[80px] px-4 border-b relative">
  
  {/* Company Logo Container */}
  <div 
    className="flex items-center justify-center h-full"
    style={{ width: `${dividerPosition}px` }}
  >
    {companyLogo && (
      <img 
        src={companyLogo} 
        alt="Company Logo" 
        className="max-h-[55px] object-contain"
        style={{ 
          transform: `scale(${logoScales.primary})`,
          transformOrigin: 'center center',
        }}
      />
    )}
  </div>
  
  {/* Vertical Divider Line */}
  <div 
    className="h-[50px] bg-gray-300"
    style={{ 
      width: '1px',
      marginLeft: '8px',
      marginRight: '8px',
    }}
  />
  
  {/* Secondary Logo Container */}
  <div 
    className="flex items-center justify-center h-full flex-1"
    style={{ 
      transform: `translateY(${secondaryLogoOffsetY}px)`,
    }}
  >
    {secondaryLogo && (
      <img 
        src={secondaryLogo} 
        alt="Secondary Logo" 
        className="max-h-[50px] object-contain"
        style={{ 
          transform: `scale(${logoScales.secondary})`,
          transformOrigin: 'center center',
        }}
      />
    )}
  </div>
  
  {/* Price Badge - Positioned at right */}
  <div className="absolute right-0 top-0 bg-[#8B7355] text-white px-6 py-3 text-right">
    <div className="text-[10px] uppercase tracking-wider opacity-80">Offered At</div>
    <div className="text-xl font-bold">{price || '$0'}</div>
  </div>
</div>
```

---

## ğŸ“¤ Include in Export

Pass logo data to the export endpoint:

```typescript
const handleExportPNG = async () => {
  const response = await fetch('/api/flyer/export-png', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      transactionId,
      formData: watchedValues,
      images: {
        mainImage,
        kitchenImage,
        roomImage,
        agentPhoto,
        companyLogo,      // â† Include company logo
        secondaryLogo,    // â† Include secondary logo
        qrCode,
      },
      logoScales,           // â† Include logo scales
      dividerPosition,      // â† Include divider position
      secondaryLogoOffsetY, // â† Include Y offset
      // ... other data
    }),
  });
  // ...
};
```

---

## ğŸ–¨ï¸ Server-Side Export Template

Update the HTML template on the server to use these values:

```html
<!-- Header Section -->
<div class="header" style="display: flex; align-items: center; height: 80px; padding: 0 16px; position: relative;">
  
  <!-- Company Logo -->
  <div style="width: {{dividerPosition}}px; display: flex; align-items: center; justify-content: center;">
    {{#if companyLogo}}
      <img 
        src="{{companyLogo}}" 
        alt="Company Logo" 
        style="max-height: 55px; object-fit: contain; transform: scale({{logoScales.primary}});"
      />
    {{/if}}
  </div>
  
  <!-- Divider -->
  <div style="width: 1px; height: 50px; background: #d1d5db; margin: 0 8px;"></div>
  
  <!-- Secondary Logo -->
  <div style="flex: 1; display: flex; align-items: center; justify-content: center; transform: translateY({{secondaryLogoOffsetY}}px);">
    {{#if secondaryLogo}}
      <img 
        src="{{secondaryLogo}}" 
        alt="Secondary Logo" 
        style="max-height: 50px; object-fit: contain; transform: scale({{logoScales.secondary}});"
      />
    {{/if}}
  </div>
  
  <!-- Price Badge -->
  <div style="position: absolute; right: 0; top: 0; background: #8B7355; color: white; padding: 12px 24px; text-align: right;">
    <div style="font-size: 10px; text-transform: uppercase; letter-spacing: 0.1em; opacity: 0.8;">Offered At</div>
    <div style="font-size: 24px; font-weight: bold;">{{price}}</div>
  </div>
</div>
```

---

## ğŸ“¦ Required Imports

```typescript
import { useState, useRef } from 'react';
import { Slider } from '@/components/ui/slider';
import { Label } from '@/components/ui/label';
import { Checkbox } from '@/components/ui/checkbox';
import { Separator } from '@/components/ui/separator';
import { Palette, Upload } from 'lucide-react';
```

---

## ğŸ“± Mobile Optimization

Ensure sliders have proper touch targets:

```tsx
<Slider
  className="py-2" // Adds vertical padding for easier touch
  // ... other props
/>
```

The slider component from shadcn/ui should already have good touch support, but verify:
- Thumb is at least 44px touch target
- Track is easy to tap

---

## âœ… Testing Checklist

### Logo Upload
- [ ] Click Company Logo area â†’ file picker opens
- [ ] Upload custom logo â†’ displays in preview
- [ ] "Use Spyglass Default" checkbox â†’ loads default logo
- [ ] Click Secondary Logo area â†’ file picker opens
- [ ] Upload custom logo â†’ displays in preview
- [ ] "Use Leading RE Default" checkbox â†’ loads default logo

### Logo Sliders
- [ ] Primary Logo Size slider â†’ logo scales in preview (50%-200%)
- [ ] Secondary Logo Size slider â†’ logo scales in preview (50%-200%)
- [ ] Divider Position slider â†’ divider line moves (100-200px)
- [ ] Secondary Logo Y Position â†’ secondary logo moves up/down (Â±20px)

### Live Preview
- [ ] Both logos display in header
- [ ] Divider line visible between logos
- [ ] Logo sizes reflect slider values
- [ ] Secondary logo Y position reflects slider value

### Export
- [ ] PNG export includes both logos with correct sizing
- [ ] PNG export includes divider at correct position
- [ ] CMYK export includes both logos with correct sizing
- [ ] Exported logos match Live Preview exactly