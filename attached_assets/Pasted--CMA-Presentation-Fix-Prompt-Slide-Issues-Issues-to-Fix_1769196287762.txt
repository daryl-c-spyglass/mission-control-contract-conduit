# CMA Presentation â€” Fix Prompt: Slide Issues

## ðŸ“‹ Issues to Fix

| # | Issue | Priority |
|---|-------|----------|
| 1 | Duplicate slide title (shown twice) | HIGH |
| 2 | Drawing tool Clear/Close buttons not working | HIGH |
| 3 | Navigation "Next" title cut off | MEDIUM |

---

## ðŸ”§ Fix 1: Remove Duplicate Slide Title

**Current Problem:**
The slide shows the title TWICE:
1. In the dark header: "AGENT RESUME" + "1/33"
2. Below header: Orange underlined "AGENT RESUME"

**Expected:** Only ONE title in the header area

### Find and Fix:

```bash
# Search for duplicate title rendering
grep -rn "widget.title\|section.title" --include="*.tsx" client/src/components/cma-presentation/
```

**Fix Pattern:**

```tsx
// In SlideViewer.tsx - KEEP this title
<div className="bg-[#1a1a2e] py-4 px-6 text-center">
  <h1 className="text-white text-xl font-bold tracking-wider uppercase">
    {widget.title}
  </h1>
  <span className="text-white/60 text-sm">{slideNumber} / {totalSlides}</span>
</div>

// In widget components or content area - REMOVE duplicate title
// DELETE any <h2>{widget.title}</h2> or similar in the content area
```

---

## ðŸ”§ Fix 2: Drawing Tool Buttons Not Working

**Current Problem:**
- Trash/Clear button (ðŸ—‘ï¸) doesn't clear the drawing
- X/Close button doesn't close the drawing mode

### Fix DrawingCanvas.tsx:

```tsx
// Ensure clear function works
const handleClear = () => {
  const canvas = canvasRef.current;
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  if (!ctx) return;
  
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  console.log('Canvas cleared'); // Debug
};

// Ensure close function calls parent handler
const handleClose = () => {
  console.log('Close clicked'); // Debug
  handleClear(); // Optional: clear before closing
  
  if (onClose) {
    onClose();
  }
};

// Buttons - ensure onClick is connected
<div className="fixed bottom-8 left-1/2 -translate-x-1/2 z-[60] flex gap-2">
  <button
    type="button"
    onClick={handleClear}
    className="min-w-[44px] min-h-[44px] p-3 bg-gray-700 hover:bg-gray-600 rounded-full"
  >
    <Trash className="w-5 h-5 text-white" />
  </button>
  
  <button
    type="button"
    onClick={handleClose}
    className="min-w-[44px] min-h-[44px] p-3 bg-[#EF4923] hover:bg-[#D13D1A] rounded-full"
  >
    <X className="w-5 h-5 text-white" />
  </button>
</div>
```

### Check Parent Component passes onClose:

```tsx
// In parent component (SlideViewer or similar)
const [isDrawingMode, setIsDrawingMode] = useState(false);

{isDrawingMode && (
  <DrawingCanvas 
    onClose={() => {
      console.log('Closing drawing mode from parent');
      setIsDrawingMode(false);
    }}
  />
)}
```

---

## ðŸ”§ Fix 3: Navigation "Next" Title Cut Off

**Current:** "LISTING WITH SPY..." (cut off)
**Expected:** Proper truncation with ellipsis or responsive text

### Fix BottomNavigation.tsx:

```tsx
{/* Next Button */}
<button
  onClick={onNext}
  disabled={currentSlide >= totalSlides}
  className="flex items-center gap-2 px-3 py-2 text-white disabled:opacity-50 min-w-[44px] min-h-[44px]"
>
  {/* Text hidden on mobile, truncated on tablet+ */}
  <span className="hidden sm:inline truncate max-w-[120px] text-sm text-right">
    {nextWidget?.title || 'Next'}
  </span>
  <ChevronRight className="w-5 h-5 flex-shrink-0" />
</button>

{/* Previous Button - same pattern */}
<button
  onClick={onPrev}
  disabled={currentSlide <= 1}
  className="flex items-center gap-2 px-3 py-2 text-white disabled:opacity-50 min-w-[44px] min-h-[44px]"
>
  <ChevronLeft className="w-5 h-5 flex-shrink-0" />
  <span className="hidden sm:inline truncate max-w-[120px] text-sm">
    {prevWidget?.title || 'Previous'}
  </span>
</button>
```

---

## ðŸ“‹ Copy/Paste for Replit

```
Fix these 3 issues in CMA Presentation:

## 1. DUPLICATE SLIDE TITLE
Title "AGENT RESUME" appears twice - in dark header AND below with orange underline.
- KEEP only the title in the dark header (with "1/33" slide count)
- REMOVE the duplicate title with orange underline below
- Check SlideViewer.tsx and widget components for duplicate rendering

## 2. DRAWING TOOL BUTTONS NOT WORKING
Clear (trash) and Close (X) buttons don't respond to clicks.

In DrawingCanvas.tsx:
a) Add console.log to handleClear and handleClose to verify they're being called
b) Ensure handleClear uses: ctx.clearRect(0, 0, canvas.width, canvas.height)
c) Ensure handleClose calls the onClose prop passed from parent
d) Check parent is passing: onClose={() => setIsDrawingMode(false)}
e) Verify buttons have z-index above canvas (z-[60] or higher)
f) Add type="button" to prevent form submission issues

## 3. NAVIGATION "NEXT" TITLE CUT OFF
"LISTING WITH SPY..." needs proper truncation.

In BottomNavigation.tsx:
- Add: className="truncate max-w-[120px]" to title span
- Hide on mobile: className="hidden sm:inline truncate max-w-[120px]"
- Keep icon visible: className="flex-shrink-0" on ChevronRight

Debug by adding console.log to button handlers for issue #2.
```

---

## âœ… Expected Results

| Issue | Before | After |
|-------|--------|-------|
| Duplicate title | "AGENT RESUME" Ã— 2 | Single title in header only |
| Clear button | Nothing happens | Canvas clears |
| Close button | Nothing happens | Drawing mode closes |
| Next nav | "LISTING WITH SPY..." | Full text or "..." truncation |