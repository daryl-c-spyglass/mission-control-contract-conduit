# CMA Presentation â€” Add Zoom Controls for Static Widget Slides (11-33)

## ðŸŽ¯ Objective

Add zoom in/out and expand functionality for the static widget images on slides 11-33 in the **slide editor view only**. This will NOT affect Preview or PDF Download formatting.

---

## ðŸ“‹ Current vs Improved

| Feature | Current | Improved |
|---------|---------|----------|
| Image size | Small (~280px) | Larger (~500px default) |
| Zoom controls | None | 50% - 200% zoom |
| Pan/scroll | Not possible | Scrollable container |
| Fullscreen | Not available | Expand/lightbox button |
| Text readability | Hard to read | Clear at any zoom |

---

## ðŸ”§ Implementation

### 1. Create Zoom Controls Component

```tsx
// File: components/cma-presentation/SlideImageZoom.tsx

import { useState, useRef } from 'react';
import { ZoomIn, ZoomOut, Maximize2, RotateCcw, Move } from 'lucide-react';

interface SlideImageZoomProps {
  src: string;
  alt: string;
  className?: string;
}

export function SlideImageZoom({ src, alt, className }: SlideImageZoomProps) {
  const [zoomLevel, setZoomLevel] = useState(100);
  const [isLightboxOpen, setIsLightboxOpen] = useState(false);
  const containerRef = useRef<HTMLDivElement>(null);

  const handleZoomIn = () => setZoomLevel(prev => Math.min(prev + 25, 200));
  const handleZoomOut = () => setZoomLevel(prev => Math.max(prev - 25, 50));
  const handleReset = () => setZoomLevel(100);

  // Handle keyboard shortcuts
  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === '+' || e.key === '=') handleZoomIn();
    if (e.key === '-') handleZoomOut();
    if (e.key === '0') handleReset();
    if (e.key === 'Escape') setIsLightboxOpen(false);
  };

  return (
    <div 
      className={`flex flex-col ${className}`}
      onKeyDown={handleKeyDown}
      tabIndex={0}
    >
      {/* Zoom Controls Bar */}
      <div className="flex items-center justify-between bg-gray-50 border rounded-t-lg px-3 py-2">
        <span className="text-xs text-gray-500 flex items-center gap-1">
          <Move className="w-3 h-3" />
          Scroll to pan
        </span>
        
        <div className="flex items-center gap-1">
          {/* Zoom Out */}
          <button 
            onClick={handleZoomOut}
            disabled={zoomLevel <= 50}
            className="p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
            title="Zoom Out (âˆ’)"
          >
            <ZoomOut className="w-4 h-4 text-gray-600" />
          </button>
          
          {/* Zoom Level Display */}
          <div className="flex items-center bg-white border rounded px-2 py-1 min-w-16 justify-center">
            <span className="text-xs font-medium text-gray-700">{zoomLevel}%</span>
          </div>
          
          {/* Zoom In */}
          <button 
            onClick={handleZoomIn}
            disabled={zoomLevel >= 200}
            className="p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
            title="Zoom In (+)"
          >
            <ZoomIn className="w-4 h-4 text-gray-600" />
          </button>
          
          {/* Reset */}
          <button 
            onClick={handleReset}
            className="p-1.5 rounded hover:bg-gray-200 transition-colors ml-1"
            title="Reset (0)"
          >
            <RotateCcw className="w-4 h-4 text-gray-600" />
          </button>
          
          {/* Divider */}
          <div className="w-px h-5 bg-gray-300 mx-2" />
          
          {/* Expand Button */}
          <button 
            onClick={() => setIsLightboxOpen(true)}
            className="flex items-center gap-1 px-2 py-1 rounded hover:bg-gray-200 transition-colors"
            title="Expand to fullscreen"
          >
            <Maximize2 className="w-4 h-4 text-gray-600" />
            <span className="text-xs text-gray-600">Expand</span>
          </button>
        </div>
      </div>
      
      {/* Image Container with Scroll */}
      <div 
        ref={containerRef}
        className="border border-t-0 rounded-b-lg overflow-auto bg-white"
        style={{ maxHeight: '400px' }}
      >
        <div 
          className="transition-transform duration-200 ease-out p-4"
          style={{ 
            transform: `scale(${zoomLevel / 100})`,
            transformOrigin: 'top left',
            width: `${100 / (zoomLevel / 100)}%`,
          }}
        >
          <img 
            src={src}
            alt={alt}
            className="w-full h-auto rounded shadow-sm"
            draggable={false}
          />
        </div>
      </div>
      
      {/* Lightbox Modal */}
      {isLightboxOpen && (
        <ImageLightbox
          src={src}
          alt={alt}
          onClose={() => setIsLightboxOpen(false)}
        />
      )}
    </div>
  );
}
```

### 2. Create Lightbox Component

```tsx
// File: components/cma-presentation/ImageLightbox.tsx

import { useState, useEffect } from 'react';
import { X, ZoomIn, ZoomOut, RotateCcw } from 'lucide-react';

interface ImageLightboxProps {
  src: string;
  alt: string;
  onClose: () => void;
}

export function ImageLightbox({ src, alt, onClose }: ImageLightboxProps) {
  const [zoomLevel, setZoomLevel] = useState(100);

  const handleZoomIn = () => setZoomLevel(prev => Math.min(prev + 25, 300));
  const handleZoomOut = () => setZoomLevel(prev => Math.max(prev - 25, 50));
  const handleReset = () => setZoomLevel(100);

  // Handle keyboard shortcuts
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === 'Escape') onClose();
      if (e.key === '+' || e.key === '=') handleZoomIn();
      if (e.key === '-') handleZoomOut();
      if (e.key === '0') handleReset();
    };

    document.addEventListener('keydown', handleKeyDown);
    return () => document.removeEventListener('keydown', handleKeyDown);
  }, [onClose]);

  // Prevent body scroll when lightbox is open
  useEffect(() => {
    document.body.style.overflow = 'hidden';
    return () => { document.body.style.overflow = 'auto'; };
  }, []);

  return (
    <div 
      className="fixed inset-0 z-50 bg-black/95 flex items-center justify-center"
      onClick={onClose}
    >
      {/* Close Button */}
      <button 
        onClick={onClose}
        className="absolute top-4 right-4 p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors z-10"
        aria-label="Close"
      >
        <X className="w-6 h-6 text-white" />
      </button>
      
      {/* Zoom Controls */}
      <div className="absolute bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-3 bg-black/50 backdrop-blur-sm rounded-lg px-4 py-2 z-10">
        <button 
          onClick={(e) => { e.stopPropagation(); handleZoomOut(); }}
          disabled={zoomLevel <= 50}
          className="p-2 hover:bg-white/10 rounded disabled:opacity-50 transition-colors"
        >
          <ZoomOut className="w-5 h-5 text-white" />
        </button>
        
        <span className="text-white font-medium min-w-16 text-center">
          {zoomLevel}%
        </span>
        
        <button 
          onClick={(e) => { e.stopPropagation(); handleZoomIn(); }}
          disabled={zoomLevel >= 300}
          className="p-2 hover:bg-white/10 rounded disabled:opacity-50 transition-colors"
        >
          <ZoomIn className="w-5 h-5 text-white" />
        </button>
        
        <div className="w-px h-5 bg-white/30" />
        
        <button 
          onClick={(e) => { e.stopPropagation(); handleReset(); }}
          className="px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded text-white text-sm transition-colors"
        >
          Reset
        </button>
      </div>
      
      {/* Image */}
      <div 
        className="overflow-auto max-w-full max-h-full p-8"
        onClick={(e) => e.stopPropagation()}
      >
        <img 
          src={src}
          alt={alt}
          className="transition-transform duration-200 ease-out rounded-lg shadow-2xl"
          style={{ 
            transform: `scale(${zoomLevel / 100})`,
            transformOrigin: 'center',
            maxWidth: 'none',
          }}
          draggable={false}
        />
      </div>
      
      {/* Keyboard hints */}
      <div className="absolute bottom-6 right-6 text-white/50 text-xs">
        <p>+ / âˆ’ to zoom â€¢ 0 to reset â€¢ Esc to close</p>
      </div>
    </div>
  );
}
```

### 3. Update Static Widget Slide Component

```tsx
// File: Find the component that renders slides 11-33

import { SlideImageZoom } from './SlideImageZoom';

// STATIC_SLIDE_IMAGES mapping (slides 11-33)
const STATIC_SLIDE_IMAGES: Record<string, string> = {
  'home_selling_system': '/cma-widgets/11-home-selling-system.png',
  'our_proven_approach': '/cma-widgets/12-our-proven-approach.png',
  // ... slides 13-30 ...
  'select_move_program': '/cma-widgets/31-select-move-program.png',
  'why_spyglass': '/cma-widgets/32-why-spyglass.png',
  'contact': '/cma-widgets/33-contact.png',
};

interface StaticWidgetSlideProps {
  slideId: string;
  slideNumber: number;
  totalSlides: number;
  isEditorView?: boolean; // True when in editor, false in Preview/PDF
}

function StaticWidgetSlide({ 
  slideId, 
  slideNumber, 
  totalSlides,
  isEditorView = true 
}: StaticWidgetSlideProps) {
  const imageSrc = STATIC_SLIDE_IMAGES[slideId];
  const slideTitle = getSlideTitle(slideId); // Helper to get title from ID

  // In EDITOR VIEW: Show with zoom controls
  if (isEditorView) {
    return (
      <div className="h-full flex flex-col bg-white">
        {/* Slide Header */}
        <div className="bg-gray-900 text-white text-center py-4">
          <h2 className="text-lg font-bold uppercase">{slideTitle}</h2>
          <p className="text-orange-400 text-sm">{slideNumber} / {totalSlides}</p>
        </div>
        
        {/* Slide Content with Zoom */}
        <div className="flex-1 p-6 bg-amber-50 overflow-hidden">
          <SlideImageZoom
            src={imageSrc}
            alt={slideTitle}
            className="h-full"
          />
        </div>
        
        {/* Footer */}
        <SlideFooter slideNumber={slideNumber} totalSlides={totalSlides} />
      </div>
    );
  }

  // In PREVIEW/PDF VIEW: Render normally without zoom controls
  return (
    <div className="h-full flex flex-col bg-white">
      <div className="bg-gray-900 text-white text-center py-4">
        <h2 className="text-lg font-bold uppercase">{slideTitle}</h2>
        <p className="text-orange-400 text-sm">{slideNumber} / {totalSlides}</p>
      </div>
      
      <div className="flex-1 p-6 bg-amber-50 flex items-center justify-center">
        <img 
          src={imageSrc}
          alt={slideTitle}
          className="max-w-full max-h-full object-contain rounded shadow"
        />
      </div>
      
      <SlideFooter slideNumber={slideNumber} totalSlides={totalSlides} />
    </div>
  );
}
```

### 4. Differentiate Editor vs Preview/PDF

The key is to pass `isEditorView` prop:

```tsx
// In Slide Editor/Builder view
<StaticWidgetSlide
  slideId="select_move_program"
  slideNumber={31}
  totalSlides={33}
  isEditorView={true}  // Shows zoom controls
/>

// In Preview Modal
<StaticWidgetSlide
  slideId="select_move_program"
  slideNumber={31}
  totalSlides={33}
  isEditorView={false}  // No zoom controls, fixed size
/>

// In PDF Export
<StaticWidgetSlidePdf
  slideId="select_move_program"
  slideNumber={31}
  totalSlides={33}
  // PDF always renders at fixed size, no zoom
/>
```

---

## ðŸ“± Mobile Optimization

```tsx
// Add responsive zoom controls for touch devices

// In SlideImageZoom component, add pinch-to-zoom support:
import { usePinchZoom } from '@/hooks/usePinchZoom'; // Custom hook

// Or use a library like 'react-zoom-pan-pinch':
import { TransformWrapper, TransformComponent } from 'react-zoom-pan-pinch';

function SlideImageZoomMobile({ src, alt }: SlideImageZoomProps) {
  return (
    <TransformWrapper
      initialScale={1}
      minScale={0.5}
      maxScale={3}
      centerOnInit
    >
      {({ zoomIn, zoomOut, resetTransform, state }) => (
        <>
          {/* Zoom Controls */}
          <div className="flex items-center gap-2 mb-2">
            <button onClick={() => zoomOut()} className="p-2 rounded bg-gray-100">
              <ZoomOut className="w-4 h-4" />
            </button>
            <span className="text-sm">{Math.round(state.scale * 100)}%</span>
            <button onClick={() => zoomIn()} className="p-2 rounded bg-gray-100">
              <ZoomIn className="w-4 h-4" />
            </button>
            <button onClick={() => resetTransform()} className="px-2 py-1 text-sm bg-gray-100 rounded">
              Reset
            </button>
          </div>
          
          {/* Zoomable Image */}
          <TransformComponent>
            <img src={src} alt={alt} className="w-full h-auto" />
          </TransformComponent>
        </>
      )}
    </TransformWrapper>
  );
}
```

### Touch Targets

```tsx
// Ensure touch-friendly button sizes
<button className="p-3 min-w-11 min-h-11 ...">  {/* 44px minimum */}
  <ZoomIn className="w-5 h-5" />
</button>
```

---

## âœ… Verification Checklist

### Editor View (Zoom Enabled)
- [ ] Slides 11-33 show zoom controls bar
- [ ] Zoom In button increases zoom (max 200%)
- [ ] Zoom Out button decreases zoom (min 50%)
- [ ] Reset button returns to 100%
- [ ] Expand button opens fullscreen lightbox
- [ ] Scroll/pan works when zoomed in
- [ ] Keyboard shortcuts work (+, -, 0, Esc)

### Preview Modal (No Zoom)
- [ ] Slides 11-33 display WITHOUT zoom controls
- [ ] Images render at fixed optimal size
- [ ] No visual changes from current Preview behavior

### PDF Export (No Zoom)
- [ ] Slides 11-33 export at fixed size
- [ ] Images are sharp and readable
- [ ] No zoom UI elements in PDF
- [ ] Layout unchanged from current

### Mobile
- [ ] Touch targets minimum 44x44px
- [ ] Pinch-to-zoom works on touch devices
- [ ] Lightbox works in portrait and landscape
- [ ] Controls don't overlap content

---

## ðŸ“¦ Optional: Install Zoom Library

If you want pinch-to-zoom support, install:

```bash
npm install react-zoom-pan-pinch
```

This provides:
- Pinch-to-zoom on touch devices
- Mouse wheel zoom
- Pan/drag support
- Smooth animations

---

*Copy this entire prompt to Replit for Contract Conduit project.*